/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package telas;

import acessoBD.ConexaoBD;
import java.awt.Toolkit;
import java.beans.PropertyVetoException;
import java.io.InputStream;
import java.text.DateFormat;
import java.util.Date;
import javax.swing.JOptionPane;
import java.sql.*;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.view.JasperViewer;

/**
 *
 * @author gabri
 */
public class Principal extends javax.swing.JFrame {
    Connection conecta = null;
    
    /**
     * Cria novo formulario da classe Principal
     */
    public Principal() {
        initComponents();
        conecta = ConexaoBD.conector();
        setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/icones/OSSOicon.png")));
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        areadetrab = new javax.swing.JDesktopPane();
        nomeUsuario = new javax.swing.JLabel();
        data = new javax.swing.JLabel();
        textoTipoUser = new javax.swing.JLabel();
        barramenu = new javax.swing.JMenuBar();
        menuOpcoes = new javax.swing.JMenu();
        itemTrocarUser = new javax.swing.JMenuItem();
        itemSair = new javax.swing.JMenuItem();
        menuCadastro = new javax.swing.JMenu();
        itemClientes = new javax.swing.JMenuItem();
        itemOS = new javax.swing.JMenuItem();
        itemUsuarios = new javax.swing.JMenuItem();
        menuRelatorio = new javax.swing.JMenu();
        itemServicosRelatorio = new javax.swing.JMenuItem();
        itemClienteRelatorio = new javax.swing.JMenuItem();
        menuAjuda = new javax.swing.JMenu();
        itemSobre = new javax.swing.JMenuItem();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("OSSO");
        setResizable(false);
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowActivated(java.awt.event.WindowEvent evt) {
                formWindowActivated(evt);
            }
        });

        areadetrab.setBackground(new java.awt.Color(255, 255, 255));
        areadetrab.setName(""); // NOI18N
        areadetrab.setPreferredSize(new java.awt.Dimension(780, 448));

        javax.swing.GroupLayout areadetrabLayout = new javax.swing.GroupLayout(areadetrab);
        areadetrab.setLayout(areadetrabLayout);
        areadetrabLayout.setHorizontalGroup(
            areadetrabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        areadetrabLayout.setVerticalGroup(
            areadetrabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 448, Short.MAX_VALUE)
        );

        nomeUsuario.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        nomeUsuario.setText("usuario");

        data.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        data.setText("data");
        data.setVerticalAlignment(javax.swing.SwingConstants.BOTTOM);

        textoTipoUser.setText("tipo-de-usuario");
        textoTipoUser.setVerticalAlignment(javax.swing.SwingConstants.BOTTOM);

        menuOpcoes.setText("Opções");

        itemTrocarUser.setText("Trocar Usuário");
        itemTrocarUser.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                itemTrocarUserActionPerformed(evt);
            }
        });
        menuOpcoes.add(itemTrocarUser);

        itemSair.setText("Sair");
        itemSair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                itemSairActionPerformed(evt);
            }
        });
        menuOpcoes.add(itemSair);

        barramenu.add(menuOpcoes);

        menuCadastro.setText("Cadastro");

        itemClientes.setText("Clientes");
        itemClientes.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                itemClientesActionPerformed(evt);
            }
        });
        menuCadastro.add(itemClientes);

        itemOS.setText("Ordem de Serviço");
        itemOS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                itemOSActionPerformed(evt);
            }
        });
        menuCadastro.add(itemOS);

        itemUsuarios.setText("Usuários do Sistema");
        itemUsuarios.setEnabled(false);
        itemUsuarios.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                itemUsuariosActionPerformed(evt);
            }
        });
        menuCadastro.add(itemUsuarios);

        barramenu.add(menuCadastro);

        menuRelatorio.setText("Relatórios");
        menuRelatorio.setEnabled(false);

        itemServicosRelatorio.setText("Serviços");
        itemServicosRelatorio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                itemServicosRelatorioActionPerformed(evt);
            }
        });
        menuRelatorio.add(itemServicosRelatorio);

        itemClienteRelatorio.setText("Clientes");
        itemClienteRelatorio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                itemClienteRelatorioActionPerformed(evt);
            }
        });
        menuRelatorio.add(itemClienteRelatorio);

        barramenu.add(menuRelatorio);

        menuAjuda.setText("Ajuda");

        itemSobre.setText("Sobre");
        itemSobre.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                itemSobreActionPerformed(evt);
            }
        });
        menuAjuda.add(itemSobre);

        barramenu.add(menuAjuda);

        setJMenuBar(barramenu);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(areadetrab, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(nomeUsuario)
                        .addGap(18, 18, 18)
                        .addComponent(textoTipoUser)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 608, Short.MAX_VALUE)
                        .addComponent(data)))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(areadetrab, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(nomeUsuario)
                    .addComponent(textoTipoUser)
                    .addComponent(data))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {data, nomeUsuario, textoTipoUser});

        setSize(new java.awt.Dimension(808, 538));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents
    
    private void itemOSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_itemOSActionPerformed
        /*Opção do menu Cadastro > Ordem de Serviço*/
        OS cad_os = new OS();
        cad_os.setVisible(true);
        areadetrab.add(cad_os);
        try {
            cad_os.setMaximum(true);
        } catch (PropertyVetoException e) {
            JOptionPane.showMessageDialog(null, e);
        }
    }//GEN-LAST:event_itemOSActionPerformed

    private void formWindowActivated(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowActivated
        /*Formatação de Data e Hora na tela principal*/
        Date datas = new Date();
        DateFormat dataformatado = DateFormat.getDateTimeInstance();
        data.setText(dataformatado.format(datas));
    }//GEN-LAST:event_formWindowActivated

    private void itemSairActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_itemSairActionPerformed
        /*Opção do menu Opções > Sair*/
        int sair = JOptionPane.showConfirmDialog(null, "Deseja sair?","Sair",JOptionPane.YES_NO_OPTION);
        if (sair == JOptionPane.YES_OPTION) {
            System.exit(0);
        }
    }//GEN-LAST:event_itemSairActionPerformed

    private void itemSobreActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_itemSobreActionPerformed
        /*Opção do menu Ajuda > Sobre*/
        Sobre chamarsobre = new Sobre();
        chamarsobre.setVisible(true);
    }//GEN-LAST:event_itemSobreActionPerformed

    private void itemUsuariosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_itemUsuariosActionPerformed
        /*Opção do menu Cadastro >  Usuários do Sistema*/
        Usuario cad_usuario = new Usuario();
        cad_usuario.setVisible(true);
        areadetrab.add(cad_usuario);
        try {
            cad_usuario.setMaximum(true);
        } catch (PropertyVetoException e) {
            JOptionPane.showMessageDialog(null, e);
        }
    }//GEN-LAST:event_itemUsuariosActionPerformed

    private void itemClientesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_itemClientesActionPerformed
        /*Opção do menu Cadastro > Clientes*/
        Cliente cad_cliente = new Cliente();
        cad_cliente.setVisible(true);
        areadetrab.add(cad_cliente);
        try {
            cad_cliente.setMaximum(true);
        } catch (PropertyVetoException e) {
            JOptionPane.showMessageDialog(null, e);
        }
    }//GEN-LAST:event_itemClientesActionPerformed

    private void itemClienteRelatorioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_itemClienteRelatorioActionPerformed
        /*Botao de relatorio que puxa informações do banco de dados sobre clientes e exporta*/
        int confirmacao = JOptionPane.showConfirmDialog(null, "Emitir relatório de Clientes?", "Atenção", JOptionPane.YES_NO_OPTION);
        if (confirmacao == JOptionPane.YES_OPTION) {
            try {
                InputStream path = getClass().getResourceAsStream("/relatorios/ireport/relatorioClientes.jasper");
                JasperPrint emite = JasperFillManager.fillReport(path, null, conecta);
                JasperViewer.viewReport(emite, false);
            } catch (Exception e) {
                JOptionPane.showMessageDialog(null, e);
            }
        }
    }//GEN-LAST:event_itemClienteRelatorioActionPerformed

    private void itemServicosRelatorioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_itemServicosRelatorioActionPerformed
        /*Botao de relatorio que puxa informações do banco de dados sobre OS e clientes e exporta*/
        int confirmacao = JOptionPane.showConfirmDialog(null, "Emitir relatório de Serviços?", "Atenção", JOptionPane.YES_NO_OPTION);
        if (confirmacao == JOptionPane.YES_OPTION) {
            try {
                InputStream path = getClass().getResourceAsStream("/relatorios/ireport/relatorioServicos.jasper");
                JasperPrint emite = JasperFillManager.fillReport(path, null, conecta);
                JasperViewer.viewReport(emite, false);
            } catch (Exception e) {
                JOptionPane.showMessageDialog(null, e);
            }
        }
    }//GEN-LAST:event_itemServicosRelatorioActionPerformed

    private void itemTrocarUserActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_itemTrocarUserActionPerformed
        /*Troca o usuário chamando a tela de login*/
        int sair = JOptionPane.showConfirmDialog(null, "Deseja trocar de usuário?", "Logoff", JOptionPane.YES_NO_OPTION);
        if (sair == JOptionPane.YES_OPTION) {
            this.dispose();
            Login telaLogin = new Login();
            telaLogin.setVisible(true);
        }
    }//GEN-LAST:event_itemTrocarUserActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Principal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Principal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Principal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Principal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        
        /* Cria e mostra o formulario */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Principal().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JDesktopPane areadetrab;
    private javax.swing.JMenuBar barramenu;
    private javax.swing.JLabel data;
    private javax.swing.JMenuItem itemClienteRelatorio;
    private javax.swing.JMenuItem itemClientes;
    private javax.swing.JMenuItem itemOS;
    private javax.swing.JMenuItem itemSair;
    private javax.swing.JMenuItem itemServicosRelatorio;
    private javax.swing.JMenuItem itemSobre;
    private javax.swing.JMenuItem itemTrocarUser;
    public static javax.swing.JMenuItem itemUsuarios;
    private javax.swing.JMenu menuAjuda;
    private javax.swing.JMenu menuCadastro;
    private javax.swing.JMenu menuOpcoes;
    public static javax.swing.JMenu menuRelatorio;
    public static javax.swing.JLabel nomeUsuario;
    public static javax.swing.JLabel textoTipoUser;
    // End of variables declaration//GEN-END:variables
}
